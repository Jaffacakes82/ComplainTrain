function showComplainModal(){var n=$(this);$("#complain-modal").modal();$("#complain-modal").show()}function submitStation(){var t=$("#selected-station").val(),i,n;t=="";i=$(this).data("url");n=$("#station-search");$(n).empty();$(n).append(loadingIcon);$.get(i,{selectedStation:t},function(t){var i=$("#departures"),r=$("#departures-table > tbody");t==null||t.departureModels==null?($(n).hide(),$(departureSection).clear().append(noTrains)):($(n).hide(),$.each(t.departureModels,function(n,t){var u=t.cancellationReason==null?!1:!0,f=t.delayReason==null?!1:!0,o=t.expected=="On time"?!0:!1,i="",e;o?i=departureRowHtml.replace("{context}","success").replace("{status}",allGoodIcon):u||f?(reasonInput=!u&&f?reasonInput.replace("{reason-string}",t.delayReason):reasonInput.replace("{reason-string}",t.cancellationReason),i=departureRowHtml.replace("{context}","danger").replace("{status}",warningIcon).replace("{reason}",reasonInput)):i=departureRowHtml.replace("{context}","warning").replace("{status}",alertIcon);t.platform==null&&(t.platform="");e=i.replace("{destination}",t.destinationName).replace("{due}",t.due).replace("{expected}",t.expected).replace("{platform}",t.platform).replace("{operator}",t.operator);$(r).append(e)}),$(i).append(searchAgainNoMessage),$(i).show())})}var departureRowHtml='<tr class="{context}"><td class="status-body">{status}<\/td><td>{destination}<\/td><td>{due}<\/td><td>{expected}<\/td><td>{platform}<\/td><td class="operator-body">{operator}<\/td>{reason}';"<\/tr>";var noTrains='<div class="col-md-1"><\/div><div class="col-md-10"><h4>There doesn\'t appear to be any trains running today...<\/h4><a id="search-again" href="/" class="btn btn-default">Search again<\/a><\/div><div class="col-md-1"><\/div>',searchAgainNoMessage='<div class="col-md-12"><a id="search-again" href="/" class="btn btn-default">Search again<\/a><\/div>',warningIcon='<i class="fa fa-exclamation-circle" aria-hidden="true"><\/i>',alertIcon='<i class="fa fa-exclamation-triangle" aria-hidden="true"><\/i>',allGoodIcon='<i class="fa fa-check-circle-o" aria-hidden="true"><\/i>',loadingIcon='<i class="fa fa-cog fa-spin fa-3x fa-fw"><\/i><span class="sr-only">Loading...<\/span>',reasonInput='<input type="hidden" value="{reason-string}" />';$(function(){$("#departures").hide();$("#station").autocomplete({source:function(n,t){$.ajax({url:"/Home/SearchStations",dataType:"json",data:{term:n.term},success:function(n){t(n)}})},minLength:1,select:function(n,t){$("#station").text(t.item.value);$("#selected-station").val(t.item.key)}});$("#submit-station").click(submitStation);$(document).on("click","#departures-table > tbody > tr.danger, #departures-table > tbody > tr.warning",showComplainModal)});