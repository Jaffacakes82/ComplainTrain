function showComplainModal(){var n=$(this);$("#complain-modal").modal();$("#complain-modal").show()}function submitStation(){var t=$("#selected-station").val(),i,n;t=="";i=$(this).data("url");n=$("#station-search");$(n).empty();$(n).append(loadingIcon);$.get(i,{selectedStation:t},function(t){var i=$("#departures"),r=$(".body-content"),u=$("#departures-table > tbody");t==null||t.departureModels==null?($(n).hide(),$(departureSection).clear().append(noTrains)):($(n).hide(),$.each(t.departureModels,function(n,t){var r=t.cancellationReason==null?!1:!0,f=t.delayReason==null?!1:!0,o=t.expected=="On time"?!0:!1,i="",e;o?i=departureRowHtml.replace("{context}","success").replace("{status}",allGoodIcon).replace("{complain-button}",""):r||f?(reasonInput=!r&&f?reasonInput.replace("{reason-string}",t.delayReason):reasonInput.replace("{reason-string}",t.cancellationReason),i=departureRowHtml.replace("{context}","danger row-clickable").replace("{status}",warningIcon).replace("{reason}",reasonInput).replace("{complain-button}",complainButton)):i=departureRowHtml.replace("{context}","warning row-clickable").replace("{status}",alertIcon).replace("{complain-button}",complainButton);t.platform==null&&(t.platform="");e=i.replace("{destination}",t.destinationName).replace("{due}",t.due).replace("{expected}",t.expected).replace("{expected}",t.expected).replace("{platform}",t.platform).replace("{operator}",t.operator);$(u).append(e)}),$(r).append(searchAgainNoMessage),$(i).show())})}var departureRowHtml='<tr class="{context}"><td class="status-body">{status}<\/td><td>{destination}<\/td><td>{due}<span class="expected-mob">{expected}<\/span><\/td><td class="expected-body">{expected}<\/td><td>{platform}<\/td><td class="operator-body">{operator}<\/td><td>{complain-button}<\/td>{reason}';"<\/tr>";var noTrains='<div class="col-md-1"><\/div><div class="col-md-10"><h4>There doesn\'t appear to be any trains running today...<\/h4><a id="search-again" href="/" class="btn btn-default">Search again<\/a><\/div><div class="col-md-1"><\/div>',searchAgainNoMessage='<div class="row"><div class="col-md-12"><a id="search-again" href="/" class="btn btn-default">Search again<\/a><\/div><\/div>',warningIcon='<i class="fa fa-exclamation-circle" aria-hidden="true"><\/i>',alertIcon='<i class="fa fa-exclamation-triangle" aria-hidden="true"><\/i>',allGoodIcon='<i class="fa fa-check-circle-o" aria-hidden="true"><\/i>',loadingIcon='<i class="fa fa-cog fa-spin fa-3x fa-fw"><\/i><span class="sr-only">Loading...<\/span>',reasonInput='<input type="hidden" value="{reason-string}" />',complainButton='<button type="button" class="complain-btn btn btn-default"><i class="fa fa-bullhorn" aria-hidden="true"><\/i><\/button>';$(function(){$("#departures").hide();$("#station").autocomplete({source:function(n,t){$.ajax({url:"/Home/SearchStations",dataType:"json",data:{term:n.term},success:function(n){t(n)}})},minLength:1,select:function(n,t){$("#station").text(t.item.value);$("#selected-station").val(t.item.key)}});$("#submit-station").click(submitStation);$(document).on("click touchstart",".complain-btn",showComplainModal)});