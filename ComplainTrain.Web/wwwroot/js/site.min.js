function submitStation(){var t=$("#selected-station").val(),i=$(this).data("url"),n=$("#station-search");$(n).empty();$(n).append(loadingIcon);$.get(i,{selectedStation:t},function(t){var i=$("#departures");t==null||t.departureModels==null?($(n).hide(),$(i).append(noTrains)):($(n).hide(),$.each(t.departureModels,function(n,t){var f=t.cancellationReason==null?!1:!0,e=t.delayReason==null?!1:!0,o=t.expected=="On time"?!0:!1,r="",u;r=o?departureBoardHtml.replace("{panelColour}","success").replace("{headingText}",allGoodIcon):f||e?departureBoardHtml.replace("{panelColour}","danger").replace("{headingText}",warningIcon):departureBoardHtml.replace("{panelColour}","warning").replace("{headingText}",alertIcon);u=r.replace("{destination}",t.destinationName).replace("{due}",t.due).replace("{expected}",t.expected).replace("{platform}",t.platform).replace("{operator}",t.operator);$(i).append(u)}),$(i).append(searchAgainNoMessage))})}var departureBoardHtml='<div class="col-md-3"><div class="panel panel-{panelColour} departure-board"><div class="panel-heading"><h3 class="panel-title">{headingText}<\/h3><\/div><ul class="list-group"><li class="list-group-item"><label>Destination:<\/label><span>{destination}<\/span><\/li><li class="list-group-item"><label>Due:<\/label><span>{due}<\/span><\/li><li class="list-group-item"><label>Expected:<\/label><span>{expected}<\/span><\/li><li class="list-group-item"><label>Platform:<\/label><span>{platform}<\/span><\/li><\/li><li class="list-group-item"><label>Operator:<\/label><span>{operator}<\/span><\/li><\/ul><\/div><\/div>',noTrains='<div class="col-md-1"><\/div><div class="col-md-10"><h4>There doesn\'t appear to be any trains running today...<\/h4><a id="search-again" href="/" class="btn btn-default">Search again<\/a><\/div><div class="col-md-1"><\/div>',searchAgainNoMessage='<div class="col-md-12"><a id="search-again" href="/" class="btn btn-default">Search again<\/a><\/div>',warningIcon='Warning <i class="fa fa-exclamation-circle" aria-hidden="true"><\/i>',alertIcon='Alert <i class="fa fa-exclamation-triangle" aria-hidden="true"><\/i>',allGoodIcon='All good! <i class="fa fa-check-circle-o" aria-hidden="true"><\/i>',loadingIcon='<i class="fa fa-cog fa-spin fa-3x fa-fw"><\/i><span class="sr-only">Loading...<\/span>';$(function(){$("#station").autocomplete({source:function(n,t){$.ajax({url:"/Home/SearchStations",dataType:"json",data:{term:n.term},success:function(n){t(n)}})},minLength:1,select:function(n,t){$("#station").text(t.item.value);$("#selected-station").val(t.item.key)}});$("#submit-station").click(submitStation)});